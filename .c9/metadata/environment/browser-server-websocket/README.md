{"changed":true,"filter":false,"title":"README.md","tooltip":"/browser-server-websocket/README.md","value":"Create package:\nsam package --template-file template.yaml --output-template-file packaged.yaml --s3-bucket urly-code-test\n\nUpload packaged.yaml to s3:\naws s3 cp ./packaged.yaml s3://cf-templates-g5i07om49cvg-eu-west-1/browser-server-websocket.yaml\n\n","undoManager":{"mark":-2,"position":26,"stack":[[{"start":{"row":0,"column":0},"end":{"row":66,"column":0},"action":"remove","lines":["# simple-websockets-chat-app","","This is the code and template for the simple-websocket-chat-app.  There are three functions contained within the directories and a SAM template that wires them up to a DynamoDB table and provides the minimal set of permissions needed to run the app:","","```",".","├── README.md                   <-- This instructions file","├── onconnect                   <-- Source code onconnect","├── ondisconnect                <-- Source code ondisconnect","├── sendmessage                 <-- Source code sendmessage","└── template.yaml               <-- SAM template for Lambda Functions and DDB","```","","","# Deploying to your account","","You have two choices for how you can deploy this code.","","## Serverless Application Repository","","The first and fastest way is to use AWS's Serverless Application Respository to directly deploy the components of this app into your account without needing to use any additional tools. You'll be able to review everything before it deploys to make sure you understand what will happen.  Click through to see the [application details](https://serverlessrepo.aws.amazon.com/applications/arn:aws:serverlessrepo:us-east-1:729047367331:applications~simple-websockets-chat-app).","","## AWS CLI commands","","If you prefer, you can install the [AWS SAM CLI](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html) and use it to package, deploy, and describe your application.  These are the commands you'll need to use:","","```","sam package \\","    --template-file template.yaml \\","    --output-template-file packaged.yaml \\","    --s3-bucket REPLACE_THIS_WITH_YOUR_S3_BUCKET_NAME","","sam deploy \\","    --template-file packaged.yaml \\","    --stack-name simple-websocket-chat-app \\","    --capabilities CAPABILITY_IAM \\","    --parameter-overrides MyParameterSample=MySampleValue","","aws cloudformation describe-stacks \\","    --stack-name simple-websocket-chat-app --query 'Stacks[].Outputs'","```","","## Testing the chat API","","To test the WebSocket API, you can use [wscat](https://github.com/websockets/wscat), an open-source command line tool.","","1. [Install NPM](https://www.npmjs.com/get-npm).","2. Install wscat:","``` bash","$ npm install -g wscat","```","3. On the console, connect to your published API endpoint by executing the following command:","``` bash","$ wscat -c wss://{YOUR-API-ID}.execute-api.{YOUR-REGION}.amazonaws.com/{STAGE}","```","4. To test the sendMessage function, send a JSON message like the following example. The Lambda function sends it back using the callback URL: ","``` bash","$ wscat -c wss://{YOUR-API-ID}.execute-api.{YOUR-REGION}.amazonaws.com/prod","connected (press CTRL+C to quit)","> {\"message\":\"sendmessage\", \"data\":\"hello world\"}","< hello world","```","","## License Summary","","This sample code is made available under a modified MIT license. See the LICENSE file.",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["F"]},{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["i"]},{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["r"]},{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["s"]},{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":["t"]}],[{"start":{"row":0,"column":5},"end":{"row":0,"column":6},"action":"insert","lines":[" "],"id":3},{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":["p"]},{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["a"]},{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["c"]},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["k"]},{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":["a"]},{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"insert","lines":["g"]},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["e"]}],[{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":[":"],"id":4}],[{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"remove","lines":[":"],"id":5}],[{"start":{"row":0,"column":6},"end":{"row":0,"column":13},"action":"remove","lines":["package"],"id":6}],[{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":["c"],"id":7},{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["r"]},{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["e"]},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["a"]},{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":["t"]},{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"insert","lines":["e"]}],[{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":[" "],"id":8},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["p"]},{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["a"]},{"start":{"row":0,"column":15},"end":{"row":0,"column":16},"action":"insert","lines":["c"]},{"start":{"row":0,"column":16},"end":{"row":0,"column":17},"action":"insert","lines":["k"]},{"start":{"row":0,"column":17},"end":{"row":0,"column":18},"action":"insert","lines":["a"]},{"start":{"row":0,"column":18},"end":{"row":0,"column":19},"action":"insert","lines":["g"]},{"start":{"row":0,"column":19},"end":{"row":0,"column":20},"action":"insert","lines":["e"]},{"start":{"row":0,"column":20},"end":{"row":0,"column":21},"action":"insert","lines":[":"]}],[{"start":{"row":0,"column":21},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":9}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":105},"action":"insert","lines":["sam package --template-file template.yaml --output-template-file packaged.yaml --s3-bucket urly-code-test"],"id":10}],[{"start":{"row":1,"column":105},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":11},{"start":{"row":2,"column":0},"end":{"row":3,"column":0},"action":"insert","lines":["",""]},{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"insert","lines":["T"]},{"start":{"row":3,"column":1},"end":{"row":3,"column":2},"action":"insert","lines":["h"]},{"start":{"row":3,"column":2},"end":{"row":3,"column":3},"action":"insert","lines":["e"]},{"start":{"row":3,"column":3},"end":{"row":3,"column":4},"action":"insert","lines":["n"]}],[{"start":{"row":3,"column":4},"end":{"row":3,"column":5},"action":"insert","lines":[" "],"id":12},{"start":{"row":3,"column":5},"end":{"row":3,"column":6},"action":"insert","lines":["u"]}],[{"start":{"row":3,"column":5},"end":{"row":3,"column":6},"action":"remove","lines":["u"],"id":13},{"start":{"row":3,"column":4},"end":{"row":3,"column":5},"action":"remove","lines":[" "]}],[{"start":{"row":3,"column":0},"end":{"row":3,"column":4},"action":"remove","lines":["Then"],"id":14}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":7},"action":"remove","lines":["First c"],"id":15}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["C"],"id":16}],[{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"insert","lines":["U"],"id":18},{"start":{"row":3,"column":1},"end":{"row":3,"column":2},"action":"insert","lines":["p"]},{"start":{"row":3,"column":2},"end":{"row":3,"column":3},"action":"insert","lines":["l"]},{"start":{"row":3,"column":3},"end":{"row":3,"column":4},"action":"insert","lines":["o"]},{"start":{"row":3,"column":4},"end":{"row":3,"column":5},"action":"insert","lines":["a"]},{"start":{"row":3,"column":5},"end":{"row":3,"column":6},"action":"insert","lines":["d"]}],[{"start":{"row":3,"column":6},"end":{"row":3,"column":7},"action":"insert","lines":[" "],"id":19},{"start":{"row":3,"column":7},"end":{"row":3,"column":8},"action":"insert","lines":["t"]},{"start":{"row":3,"column":8},"end":{"row":3,"column":9},"action":"insert","lines":["o"]}],[{"start":{"row":3,"column":9},"end":{"row":3,"column":10},"action":"insert","lines":[" "],"id":20}],[{"start":{"row":3,"column":10},"end":{"row":3,"column":11},"action":"insert","lines":["s"],"id":22},{"start":{"row":3,"column":11},"end":{"row":3,"column":12},"action":"insert","lines":["3"]},{"start":{"row":3,"column":12},"end":{"row":3,"column":13},"action":"insert","lines":[":"]}],[{"start":{"row":3,"column":13},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":23}],[{"start":{"row":3,"column":6},"end":{"row":3,"column":7},"action":"insert","lines":[" "],"id":25},{"start":{"row":3,"column":7},"end":{"row":3,"column":8},"action":"insert","lines":["p"]},{"start":{"row":3,"column":8},"end":{"row":3,"column":9},"action":"insert","lines":["a"]},{"start":{"row":3,"column":9},"end":{"row":3,"column":10},"action":"insert","lines":["c"]},{"start":{"row":3,"column":10},"end":{"row":3,"column":11},"action":"insert","lines":["k"]},{"start":{"row":3,"column":11},"end":{"row":3,"column":12},"action":"insert","lines":["a"]},{"start":{"row":3,"column":12},"end":{"row":3,"column":13},"action":"insert","lines":["g"]},{"start":{"row":3,"column":13},"end":{"row":3,"column":14},"action":"insert","lines":["e"]},{"start":{"row":3,"column":14},"end":{"row":3,"column":15},"action":"insert","lines":["d"]},{"start":{"row":3,"column":15},"end":{"row":3,"column":16},"action":"insert","lines":["."]},{"start":{"row":3,"column":16},"end":{"row":3,"column":17},"action":"insert","lines":["y"]}],[{"start":{"row":3,"column":17},"end":{"row":3,"column":18},"action":"insert","lines":["a"],"id":26},{"start":{"row":3,"column":18},"end":{"row":3,"column":19},"action":"insert","lines":["m"]},{"start":{"row":3,"column":19},"end":{"row":3,"column":20},"action":"insert","lines":["l"]}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":96},"action":"insert","lines":["aws s3 cp ./packaged.yaml s3://cf-templates-g5i07om49cvg-eu-west-1/browser-server-websocket.yaml"],"id":27}],[{"start":{"row":4,"column":96},"end":{"row":5,"column":0},"action":"insert","lines":["",""],"id":28},{"start":{"row":5,"column":0},"end":{"row":6,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"insert","lines":["F"],"id":29},{"start":{"row":6,"column":1},"end":{"row":6,"column":2},"action":"insert","lines":["r"]},{"start":{"row":6,"column":2},"end":{"row":6,"column":3},"action":"insert","lines":["o"]},{"start":{"row":6,"column":3},"end":{"row":6,"column":4},"action":"insert","lines":["m"]}],[{"start":{"row":6,"column":3},"end":{"row":6,"column":4},"action":"remove","lines":["m"],"id":30}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":3},"action":"remove","lines":["Fro"],"id":31}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":6,"column":0},"end":{"row":6,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1558464877311}